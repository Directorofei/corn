# 🌽 玉米病虫害诊断智能体

## 📖 项目简介

玉米病虫害诊断智能体是一个基于深度学习和专业农业知识的智能诊断系统，旨在帮助农户、农技人员快速准确地识别和诊断玉米病虫害。

### ✨ 核心特性

- 🤖 **AI智能识别**：基于ConvNext深度学习架构，准确率高达98%+
- 🔬 **多维度诊断**：涵盖叶片、害虫、茎穗、根部、苗期五大专家系统
- 📊 **专业知识整合**：结合农业专家知识库，提供详细的病害信息和防治建议
- 💻 **现代化界面**：响应式设计，支持桌面端和移动端
- ⚡ **实时诊断**：上传图片即可获得即时诊断结果

## 🏗️ 系统架构

### 五大专家系统

| 专家系统 | 识别范围 | 技术特点 |
|---------|---------|---------|
| 🍃 **叶片病害专家** | 斑病、锈病、健康状态 | 多标签分类，支持复合病害诊断 |
| 🐛 **害虫识别专家** | 粘虫、玉米螟、蓟马 | 单类别高精度识别 |
| 🌾 **茎穗病害专家** | 丝黑穗病、瘤黑粉病 | 症状关键词智能匹配 |
| 🌱 **根部病害专家** | 根腐病(青枯型/黄枯型) | 症状描述分析和诊断建议 |
| 🌿 **苗期病害专家** | 烂种、芽腐、苗枯 | 早期病害预警和环境因子分析 |

### 技术栈

- **后端框架**: Gradio + Python
- **深度学习**: PyTorch + ConvNext
- **前端技术**: HTML5 + CSS3 + JavaScript
- **图像处理**: PIL + OpenCV
- **知识库**: Markdown + 结构化数据

## 🚀 快速开始

### 环境要求

- Python 3.8+
- PyTorch 1.9+
- 显存 6GB+ (推荐RTX 3060以上)

### 安装步骤

1. **克隆项目**
```bash
git clone https://github.com/qiu15587772248/Agent-for-Common-Corn-Pest-and-Disease-Diagnosis.git
cd Agent-for-Common-Corn-Pest-and-Disease-Diagnosis
```

2. **安装依赖**
```bash
# 叶片病害专家系统
pip install -r leaf/requirements.txt

# 害虫识别专家系统  
pip install -r pests/requirements.txt

# 其他依赖
pip install gradio torch torchvision Pillow
```

3. **数据集说明**

> ⚠️ **重要说明**: 由于文件大小限制，训练数据集未包含在此仓库中。但**预训练模型文件已包含**，可直接使用。

**模型文件状态**:
- ✅ **叶片病害模型**: `leaf/models/best_model_rtx3060_stable.pth` (约500MB) - 已包含
- ✅ **害虫识别模型**: `pests/models/best_pest_model.pth` (约200MB) - 已包含

**数据集获取** (可选，仅用于重新训练):
- **叶片病害数据集**: 50000+ 原始图片 → 清洗后4000+ 高质量标注图片
- **害虫识别数据集**: 2000+ 专业害虫图片
- 数据集应放置在相应的 `datasets/` 目录下

> 📧 如需获取完整训练数据集，请联系项目维护者: cjq3172629360@163.com

4. **启动应用**
```bash
python app.py
```

访问 `http://localhost:7860` 开始使用！

> 💡 **提示**: 所有五个专家系统均可正常使用。叶片和害虫专家提供AI识别功能，茎穗、根部、苗期专家提供基于症状描述的智能诊断。

## 📊 模型性能

### 叶片病害识别性能
- **整体准确率**: 98.24%
- **复合病害识别**: 95.16%
- **支持病害类型**: 4类 (健康、锈病、大斑病、灰斑病) (多标签分类，支持复合病例)
- **训练数据量**: 50000张原始数据集——> 清洗后4000+ 高质量标注图片

### 害虫识别性能
- **整体准确率**: 98.37%
- **支持害虫类型**: 3类 (粘虫、玉米螟、蓟马)
- **训练数据量**: 2000+ 专业害虫图片

## 🔧 项目结构

```
corn-disease-diagnosis/
├── app.py                 # 主应用入口
├── README.md             # 项目说明文档
├── API_INTEGRATION_GUIDE.md # 后端API对接指南
├── assets/                # 静态资源
│   └── bot.png           # 机器人头像
├── knowledge_base/        # 专业知识库
│   ├── 斑病.md
│   ├── 锈病.md
│   ├── 玉米螟.md
│   ├── 粘虫.md
│   ├── 苗枯病.md
│   ├── 蓟马.md
│   ├── 根腐病.md
│   └── 黑粉病.md
├── test_photos_leaf/      # 叶片病害测试图片
│   ├── 健康叶片示例.jpg
│   ├── 斑病叶片示例.jpg
│   ├── 锈病叶片示例.jpg
│   └── 灰斑病叶片示例.jpg
├── test_photos_pests/     # 害虫识别测试图片
│   ├── 玉米螟示例.jpg
│   ├── 粘虫示例.jpg
│   └── 蓟马示例.jpg
├── leaf/                  # 叶片病害专家系统
│   ├── models/           # 训练好的模型文件 (✅ 已包含)
│   │   ├── best_model_rtx3060_stable.pth (500MB)
│   │   └── config.json
│   ├── datasets/         # 训练数据集 (⚠️ 未包含在仓库中，完整版包含50000+原始数据)
│   ├── data_clean/       # 数据清洗脚本
│   ├── leaf_expert.py    # 叶片专家接口
│   ├── train_rtx3060_stable.py # 训练脚本
│   └── requirements.txt  # 依赖包
├── pests/                 # 害虫识别专家系统
│   ├── models/           # 训练好的模型文件 (✅ 已包含)
│   │   ├── best_pest_model.pth (200MB)
│   │   └── config.json
│   ├── datasets/         # 害虫图片数据集 (⚠️ 未包含在仓库中)
│   ├── data_clean/       # 数据清洗脚本
│   ├── pest_expert.py    # 害虫专家接口
│   ├── train_pest_classifier.py # 训练脚本
│   └── requirements.txt  # 依赖包
├── stem/                  # 茎穗病害专家系统
│   ├── images/           # 参考图片
│   └── stem_expert.py    # 茎穗专家接口
├── root/                  # 根部病害专家系统
│   ├── images/           # 参考图片
│   └── root_expert.py    # 根部专家接口
├── seedling/              # 苗期病害专家系统
│   ├── images/           # 参考图片
│   └── seedling_expert.py # 苗期专家接口
└── utils/                 # 公共工具库
    ├── image_utils.py     # 图像预处理
    ├── model_definitions.py # 模型定义
    ├── knowledge_loader.py   # 知识库加载
    ├── inference_utils.py    # 推理工具
    └── pest_model_utils.py   # 害虫模型工具
```

## 🎯 使用方法

### 1. 叶片病害诊断
- 上传清晰的玉米叶片照片
- 系统自动识别病害类型和置信度
- 获得详细的症状分析和防治建议

### 2. 害虫识别
- 拍摄害虫特征清晰的照片
- AI识别害虫种类
- 查看生活习性和防治方法

### 3. 症状描述诊断
- 在茎穗/根部/苗期专家系统中描述症状
- 系统智能匹配可能的病害
- 获得专业的诊断建议

## 🔬 技术特点

### 深度学习模型
- **架构**: ConvNext-Base 
- **优化**: 多次迭代摸索出最优的智能学习率调度算法以及早停机制；根据农业场景选择丰富的数据增强手段
- **特性**: 支持多标签分类、置信度评估

### 知识库系统
- **结构化存储**: Markdown格式专业知识
- **智能检索**: 关键词和语义匹配
- **专家验证**: 农业专家审核的权威内容

### 前端优化
- **响应式设计**: 支持各种设备尺寸
- **微交互动画**: 流畅的用户体验
- **可访问性**: 支持键盘导航和屏幕阅读器

## 🤝 贡献指南

我们欢迎任何形式的贡献！

### 贡献方式
1. **提交Bug报告**: 在Issues中详细描述问题
2. **功能建议**: 提出新功能想法和改进建议  
3. **代码贡献**: Fork项目并提交Pull Request
4. **文档改进**: 帮助完善文档和使用说明

### 开发规范
- 遵循PEP 8代码规范
- 添加必要的注释和文档
- 提交前进行充分测试

## 📄 许可证

本项目采用 MIT 许可证，详见 [LICENSE](LICENSE) 文件。

## 📞 联系我们

- **项目维护者**: [Zephyr]
- **邮箱**: [cjq3172629360@163.com] 


---

<div align="center">
  <strong>🌽 让AI助力现代农业，守护粮食安全 🌽</strong>
</div> 