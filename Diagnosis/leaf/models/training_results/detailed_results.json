{
  "config": {
    "data_dir": "./datasets",
    "csv_path": "./datasets/multilabel_corn_disease.csv",
    "num_classes": 4,
    "batch_size": 8,
    "num_epochs": 60,
    "learning_rate": 0.00015,
    "weight_decay": 0.015,
    "warmup_epochs": 6,
    "ema_decay": 0.999,
    "grad_clip": 1.0,
    "model_name": "convnext_base_in22k",
    "save_dir": "./models",
    "use_focal_loss": true,
    "focal_alpha": 0.25,
    "focal_gamma": 2.0,
    "accumulate_steps": 4,
    "use_amp": true,
    "pin_memory": true,
    "num_workers": 4,
    "label_smoothing": 0.1,
    "early_stopping_patience": 12,
    "lr_scheduler_patience": 4
  },
  "training_time_hours": 0.2836097226540248,
  "best_epoch": 19,
  "validation_best_f1": 0.9764276579180841,
  "test_set_metrics": {
    "accuracy": 0.9516279069767442,
    "precision_macro": 0.9843185180364852,
    "precision_micro": 0.9795171909290417,
    "recall_macro": 0.9773167886118479,
    "recall_micro": 0.9788011695906432,
    "f1_macro": 0.9807191974118253,
    "f1_micro": 0.9791590493601463,
    "auc_macro": 0.9967282674210751,
    "auc_micro": 0.9979947850239492,
    "ap_macro": 0.9975239344086454,
    "ap_micro": 0.9971924188457916,
    "sensitivity_macro": 0.9773167886118479,
    "specificity_macro": 0.9754548106838392,
    "precision_per_class": [
      0.9960629921259843,
      0.9862258953168044,
      0.9706666666666667
    ],
    "recall_per_class": [
      0.98828125,
      0.9572192513368984,
      0.986449864498645
    ],
    "f1_per_class": [
      0.9921568627450981,
      0.9715061058344641,
      0.978494623655914
    ],
    "auc_per_class": [
      0.999937996031746,
      0.9982683256158125,
      0.9919784806156667
    ],
    "ap_per_class": [
      0.9997859110283847,
      0.9967538840974441,
      0.9960320081001073
    ],
    "sensitivity_per_class": [
      0.98828125,
      0.9572192513368984,
      0.986449864498645
    ],
    "specificity_per_class": [
      0.9987789987789988,
      0.992867332382311,
      0.9347181008902077
    ]
  },
  "final_class_names": [
    "正常",
    "锈病",
    "斑病"
  ],
  "history": {
    "train_loss": [
      0.0341651134155968,
      0.01574863378760444,
      0.009806984465450242,
      0.007432118676679102,
      0.00762751651147875,
      0.006320288979749383,
      0.006030131603932591,
      0.00534431135104842,
      0.00500732945110308,
      0.004410588366899405,
      0.004167282903829396,
      0.003402946129097215,
      0.0035337962254195212,
      0.003214213074884457,
      0.002707281289403728,
      0.002972851496677448,
      0.0024975029470441774,
      0.0023033972924163242,
      0.0025918696258375724
    ],
    "train_accuracy": [
      0.3385044989140552,
      0.7818802358051505,
      0.8827179646292275,
      0.905988209742476,
      0.9044368600682594,
      0.9224325162891716,
      0.9277071051815079,
      0.9354638535525908,
      0.9398076326403971,
      0.9407384424449271,
      0.9506670803599131,
      0.9494260006205398,
      0.952528699968973,
      0.9472541110766367,
      0.9596649084703692,
      0.9578032888613094,
      0.9658703071672355,
      0.9686627365808254,
      0.9677319267762954
    ],
    "train_precision": [
      0.8559988085277581,
      0.9331562842466887,
      0.9509446496735589,
      0.9607551330401664,
      0.9608336583005856,
      0.9674642718148646,
      0.9692819058018394,
      0.9734647607075811,
      0.973758142622195,
      0.9752315762500355,
      0.9770773781856944,
      0.9779365167777172,
      0.9802508380555123,
      0.9774583470036187,
      0.9828090333066157,
      0.9819240473895302,
      0.9858799856788675,
      0.987663897709013,
      0.9842352497015298
    ],
    "train_recall": [
      0.38472916360662196,
      0.8742322426958055,
      0.9485967310032279,
      0.9596087565533882,
      0.9566535631703936,
      0.9665018962367062,
      0.9681950043488813,
      0.969287152224637,
      0.9727538919674158,
      0.9748116787692688,
      0.9788167244985813,
      0.9812132531745945,
      0.97763229565563,
      0.9778616425713634,
      0.9804602248116546,
      0.9803781232046832,
      0.9866601232913581,
      0.9866528110216946,
      0.9868369953174295
    ],
    "train_f1": [
      0.511107686174153,
      0.9018363560178771,
      0.9497678837872,
      0.9601613596433026,
      0.9587335586617752,
      0.9669776627378633,
      0.9687352630427425,
      0.9713597860844931,
      0.9732444295135089,
      0.9750156880240656,
      0.9779445778341866,
      0.9795656579994848,
      0.9789373500622576,
      0.9776535627160268,
      0.9816323946014677,
      0.9811498211409561,
      0.9862681564682748,
      0.9871555732669633,
      0.985533547805202
    ],
    "train_auc": [
      0.8158905650522047,
      0.9589429913099071,
      0.9817150727679419,
      0.9891840681699885,
      0.9882086788593831,
      0.992297829571226,
      0.9927209663092732,
      0.9933992375923132,
      0.9936065254255643,
      0.9962915027248588,
      0.996382661214077,
      0.9971969700881288,
      0.9973214736656963,
      0.9974185768337627,
      0.9982895871573243,
      0.9979067219730181,
      0.9987062514213663,
      0.9986828647175588,
      0.9985359396428514
    ],
    "train_sensitivity": [
      0.38472916360662196,
      0.8742322426958055,
      0.9485967310032279,
      0.9596087565533882,
      0.9566535631703936,
      0.9665018962367062,
      0.9681950043488813,
      0.969287152224637,
      0.9727538919674158,
      0.9748116787692688,
      0.9788167244985813,
      0.9812132531745945,
      0.97763229565563,
      0.9778616425713634,
      0.9804602248116546,
      0.9803781232046832,
      0.9866601232913581,
      0.9866528110216946,
      0.9868369953174295
    ],
    "train_specificity": [
      0.8894782164416086,
      0.9241237517780684,
      0.9440402627294137,
      0.9524535986410451,
      0.9551937340052348,
      0.96364734101065,
      0.9660633956963459,
      0.9677157772002446,
      0.9676111961667734,
      0.9714748250054058,
      0.9750092927583299,
      0.9736165493257362,
      0.9783616288160283,
      0.9728492473087181,
      0.982536867587997,
      0.9794785903112633,
      0.9832090677908886,
      0.9849946006537942,
      0.9834950989245018
    ],
    "val_loss": [
      0.042553380656021614,
      0.04053889410915198,
      0.037413216878970465,
      0.03308334371281995,
      0.028136220560581595,
      0.023111622201071845,
      0.018553958895305794,
      0.01496987943020132,
      0.012235569243353827,
      0.01005530561906872,
      0.008574833224217097,
      0.007519598946803146,
      0.006804160756507405,
      0.006337273805574687,
      0.006016766322190287,
      0.005844819201889483,
      0.005795880464009113,
      0.005788347471820156,
      0.00588880292025688
    ],
    "val_accuracy": [
      0.41527001862197394,
      0.4729981378026071,
      0.6340782122905028,
      0.7430167597765364,
      0.7988826815642458,
      0.835195530726257,
      0.8687150837988827,
      0.8938547486033519,
      0.9068901303538175,
      0.9162011173184358,
      0.9245810055865922,
      0.9292364990689013,
      0.9376163873370578,
      0.9394785847299814,
      0.9404096834264432,
      0.946927374301676,
      0.946927374301676,
      0.9497206703910615,
      0.9506517690875232
    ],
    "val_precision": [
      0.6504729238124934,
      0.8536666004248937,
      0.9431396227097778,
      0.9658161558154555,
      0.9679405113523721,
      0.9712946525896166,
      0.9720652931488999,
      0.9743585298181534,
      0.9761939266546596,
      0.976555940103187,
      0.9771201678354483,
      0.9770625082106218,
      0.9797858311167446,
      0.9802223341718129,
      0.980236377537727,
      0.9798369352385832,
      0.9802641350704823,
      0.980300640490761,
      0.9793984955952442
    ],
    "val_recall": [
      0.3493132530957374,
      0.4101697831026018,
      0.6186160202273402,
      0.7545556861889674,
      0.827814687878575,
      0.8651319817592734,
      0.8978473607961514,
      0.9214092000877013,
      0.9350445385990923,
      0.9434445974849596,
      0.9527479987375838,
      0.9571754042605539,
      0.9620513999902082,
      0.9634033325636494,
      0.9643066749304063,
      0.9709955173469632,
      0.9714441075536474,
      0.9727898781737001,
      0.973693220540457
    ],
    "val_f1": [
      0.3021767790463457,
      0.41277306578223466,
      0.7056337827962741,
      0.8340432735513366,
      0.886366644934169,
      0.9109998690469797,
      0.9306592955384074,
      0.9453951719602666,
      0.9539022828853262,
      0.9587549622152713,
      0.9640597123996305,
      0.9664296294396203,
      0.9703738589947157,
      0.9713469947167699,
      0.9718367651925149,
      0.9751403709609279,
      0.9756123071873999,
      0.9763946812402052,
      0.9764276579180841
    ],
    "val_auc": [
      0.577151051179509,
      0.7284863301658134,
      0.8746468917383782,
      0.9347427002171491,
      0.9643157238724447,
      0.9791783164756622,
      0.9867010997123541,
      0.990743190192808,
      0.9928239428635757,
      0.9939085230329394,
      0.9945742203287858,
      0.9950962544633457,
      0.9954160838329758,
      0.9956647320475543,
      0.9958934840596975,
      0.9960719598454152,
      0.9962620130729642,
      0.9963665898773182,
      0.9963879135220077
    ],
    "val_ap": [
      0.48684673394843303,
      0.6502063478171287,
      0.8509200630332304,
      0.9265039875223399,
      0.9562552146849814,
      0.9783264448481853,
      0.9875808292490708,
      0.9917983828439829,
      0.9937770251911755,
      0.994699878409282,
      0.9953306376545358,
      0.995830197714239,
      0.9960525927128522,
      0.9962308727024274,
      0.9963843356869845,
      0.9964912912313969,
      0.9966347086708905,
      0.996711710995514,
      0.9967066037851929
    ],
    "val_sensitivity": [
      0.3493132530957374,
      0.4101697831026018,
      0.6186160202273402,
      0.7545556861889674,
      0.827814687878575,
      0.8651319817592734,
      0.8978473607961514,
      0.9214092000877013,
      0.9350445385990923,
      0.9434445974849596,
      0.9527479987375838,
      0.9571754042605539,
      0.9620513999902082,
      0.9634033325636494,
      0.9643066749304063,
      0.9709955173469632,
      0.9714441075536474,
      0.9727898781737001,
      0.973693220540457
    ],
    "val_specificity": [
      0.6664439971539796,
      0.7137738502491038,
      0.8607197576312196,
      0.9242583695569282,
      0.9325832102771018,
      0.9418855681038248,
      0.9453841138962774,
      0.9552524661958048,
      0.9591625346220023,
      0.9616222727028797,
      0.9625997898094291,
      0.9640820107837572,
      0.9684648924487252,
      0.9694424095552746,
      0.9694424095552746,
      0.9699471134230534,
      0.9709246305296028,
      0.973445659215506,
      0.9729728459767353
    ],
    "val_final_f1": [
      0.3021767790463457,
      0.41277306578223466,
      0.7056337827962741,
      0.8340432735513366,
      0.886366644934169,
      0.9109998690469797,
      0.9306592955384074,
      0.9453951719602666,
      0.9539022828853262,
      0.9587549622152713,
      0.9640597123996305,
      0.9664296294396203,
      0.9703738589947157,
      0.9713469947167699,
      0.9718367651925149,
      0.9751403709609279,
      0.9756123071873999,
      0.9763946812402052,
      0.9764276579180841
    ]
  },
  "data_split": {
    "train_samples": 3223,
    "val_samples": 1074,
    "test_samples": 1075
  }
}